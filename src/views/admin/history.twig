{% extends 'base.twig' %}

{% block title %}Manage History
{% endblock %}

{% block content %}
	<h1 class="text-3xl font-bold mb-3">History Management</h1>

	<div class="mb-3">
		<form action="/admin/history" method="POST">
			<input type="hidden" name="historyId" value="{{ history.historyId ?? '' }}">

			<div class="grid grid-cols-2 gap-3">
				<label for="chapter">Chapter Name:</label>
				<input type="text" id="chapter" name="chapter" required class="border-0 rounded p-2" value="{{ history.chapter ?? '' }}">

				<label for="title">Title:</label>
				<input type="text" id="title" name="title" required class="border-0 rounded p-2" value="{{ history.title ?? '' }}">

				<div class="shadow-sm mb-3 min-w-full">
					<table class="table-auto min-w-full text-sm md:text-base">
						<thead>
							<tr class="text-left">
								<th class="border p-2">
									<button class="bg-blue-500 rounded p-2">A</button>
								</th>
								<th class="border p-2">Content</th>
								<th class="border p-2">Images</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="border p-2">
									<a href="/admin/history/{{ history.contentId }}" class="bg-red-500 rounded p-2">D</a>
								</td>
								<td class="border p-2">
									<textarea id="content" name="content" required class="border-0 rounded p-2">
										{{ history.content ?? '' }}
									</textarea>
								</td>
								<td class="border p-2">
									<input type="file" name="images" id="images" class="border-0 rounded p-2">
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<button type="submit" class="bg-blue-500 text-white p-2 rounded">Save Chapter</button>
		</form>
	</div>

	<h2 class="text-2xl mt-4">Existing Chapter Entries</h2>
	{% for chapter in chapters %}
		<div class="mb-3">
			<h3>{{ chapter.chapter }}</h3>
			<h4>{{ chapter.title }}</h4>

			{% for content in chapter.contents %}
				<div class="mb-2">
					<p>{{ content.content }}</p>

					{% if content.leftImage %}
						<img src="{{ content.leftImage }}" alt="Left Image"/>
					{% endif %}
					{% if content.rightImage %}
						<img src="{{ content.rightImage }}" alt="Right Image"/>
					{% endif %}
				</div>
			{% endfor %}
		</div>
	{% endfor %}
{% endblock %}
